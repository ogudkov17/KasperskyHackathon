
### Диаграмма взаимодействия компонентов обработки данных

Рассмотрим базовую диаграмму потоков данных, как в примерах. Из разборов следует, что блок получения данных должен повышать доверие к данным, а блоки обработки и передачи данных должны быть доверенными.

![Диаграмма взаимодействия компонентов, как в разборе](../uml/images/basedataproc.png)

Таким образом, весь код блока УД нужно будет проверять.

### Предложения по изменению архитектуры обработки данных

Такой вариант схемы недостаточно отражает условия по проектированию защищенной системы киберимунным подходом, поэтому предлагается детализировать диаграмму.

![Предлагаемые изменения во взаимодействие компонентов](../uml/images/DeviceComponentFlow.png)

Для обеспечения целостности данных предполагается использовать алгоритмы электронной цифровой подписи и проверки. Для этого также потребуется доверенный удостоверяющий центр вне УД, а также дополнительные элементы в СУЗ и АСУ ТП по проверке входящих данных, обладающих цифровой подписью.

Также для невозможности дублирования пакетов злоумышленником предлагается использовать модуль доверенного времени, которое также потребуется в системе журналирования.

Несмотря на то, что доверенных и повышающих доверие компонентов стало больше, однако, были выделены блоки, которые могут остаться недоверенными и могут содержать большую часть кода по передачи данных в различных форматах. При этом код повышающих доверие компонентов невелик. Объем кода криптографических блоков подписи и проверки подписи зависит от реализации. Для этого планируется отдельный блок информации.

В данной схеме потенциально можно блок порогового сравнения сделать недоверенным компонентом с соответствующей переделкой блока подписи в компонент, повышающий доверие, но код данного компонента небольшой, и выгода от его недоверенности не ощутима.

Стоит также заметить, что УЦ в данной схеме ни с какими блоками не взаимодействует и имеет лишь ассоциации, заключающиеся в том, что для работы предложенной схемы требуется стандартное распределение открытых (для блоков проверки подписи) и закрытых (для блока подписи) ключей.

Блоки доверенного времени и УЦ скорее всего не имеют существенных накладных расходов по интеграции, так как такие элементы предположительно уже существуют в инфраструктуре.

### Операции подсистемы обработки данных

#### Обработка данных датчика

![Обработка данных датчика](../uml/images/SeqDeviceProc.png)

### Негативные варианты


#### Нарушение в обработке данных в блоке обработки данных

В недоверенном блоке обработки данных данные могут:
* изменяться
* генерироваться новые
* использоваться уже переданные
* удаляться

![Изменение данных в блоке обработки данных](../uml/images/SeqDeviceDataProcChangeNegative.png)

Изменение данных в блоке обработки данных обнаруживается при проверке подписи в блоке порогового сравнения либо при проверке подписи в АСУ ТП

![Создание новых данных в блоке обработки данных](../uml/images/SeqDeviceDataProcNewNegative.png)

Добавление новых данных в блоке обработки данных требует подписи созданного сообщения. При этом доступа к блоку формирования подписи у компонента нет. Ситуация генерации новых неподписанных данных обнаруживается при проверке подписи в блоке порогового сравнения либо при проверке подписи в АСУ ТП.

![Использование переданных данных в блоке обработки данных](../uml/images/SeqDeviceDataProcRepeatNegative.png)

Использование переданных данных в блоке обработки данных не требует подписи созданного сообщения. Но при этом используется старая временная метка, которую компонент не может изменить без нарушения подписи. Ситуация использования переданных сообщений обнаруживается при проверке временной метки или подписи в блоке порогового сравнения либо при проверке временной метки или подписи в АСУ ТП.

Удаление данных не приводит к тревоге в УД, но может быть обнаружено, что данные не приходят какое-то количество времени в СУЗ или АСУ ТП.

#### Изменение данных в блоке передачи данных

В недоверенном блоке передачи данных данные могут:
* изменяться
* генерироваться новые
* использоваться уже переданные
* удаляться

![Изменение данных в блоке передачи данных](../uml/images/SeqDeviceDataOutputChangeNegative.png)

Изменение данных в блоке передачи данных обнаруживается при проверке подписи при проверке подписи в АСУ ТП

![Создание новых данных в блоке передачи данных](../uml/images/SeqDeviceDataOutputNewNegative.png)

Добавление новых данных в блоке передачи данных требует подписи созданного сообщения. При этом доступа к блоку формирования подписи у компонента нет. Ситуация генерации новых неподписанных данных обнаруживается при проверке подписи при проверке подписи в АСУ ТП.

![Использование переданных данных в блоке обработки данных](../uml/images/SeqDeviceDataOutputRepeatNegative.png)

Использование переданных данных в блоке передачи данных не требует подписи созданного сообщения. Но при этом используется старая временная метка и идентификатор сообщения, которую компонент не может изменить без нарушения подписи. Ситуация использования переданных сообщений обнаруживается при проверке временной метки или подписи проверке временной метки или подписи в АСУ ТП.

Удаление данных не приводит к тревоге в УД, но может быть обнаружено, что данные не приходят какое-то количество времени в АСУ ТП.


Целостность данных при предложенной архитектуре не нарушается, но измененные данные могут быть недоступны. Такая ситуация при модификации СУЗ или АСУ ТП может быть обнаружена при контроле времени работы без данных.
